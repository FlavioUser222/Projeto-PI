<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inclusive.com</title>
    <link rel="stylesheet" href="./styles/inclusive.css">
</head>

<body>
    <header>
        <!-- <img src="" alt="Inclusive.com"> -->
        <h1>Inclusive.com</h1>
        <div class="input-Img">
            <input type="text" placeholder="Pesquisar curso" id="pesquisarCurso">
            <img src="../imagens/search.png" alt="√çcone pesquisa">
        </div>


    </header>

    <div class="container">

        <div class="acessibilidade">
            <a href="javascript:void(0)" onclick="clickAcessibilidade()"><img src="../imagens/acessibilidade.png"
                    alt=""></a>
            <div class="options-acessibilidade" id="optionsAcessibilidade">
                <a href="javascript:void(0)" id="btnContraste"><img src="../imagens/contrast.png"
                        alt="√çcone contraste">Alto contraste</a>
                <a href="javascript:void(0)" id="btnMais"><img src="../imagens/mais.png" alt="Simbolo soma">Aumentar a
                    fonte</a>
                <a href="javascript:void(0)" id="btnMenos"><img src="../imagens/minus-big-symbol.png"
                        alt="Simbolo de subtra√ß√£o">Diminuir a fonte</a>
                <a href="javascript:void(0)" id="btnDaltonismo"><img src="../imagens/color-blindness-test.png"
                        alt="√çcone daltonismo">Daltonismo</a>
            </div>
        </div>

        <div class="buttons-opt">
            <ul id="lista-categorias"></ul>

        </div>

        <div class="content">
            <h1 class="titulo1">Conhe√ßa nossos tutoriais</h1>
            <div class="content-videos" id="content-videos"></div>
        </div>


        <footer>
            <div class="footer-Img">
                <img src="" alt="">
            </div>

            <div class="redes">
                <a href=""><img src="../imagens/facebook.png" alt=""></a>
                <a href=""><img src="../imagens/gmail.png" alt=""></a>
                <a href=""><img src="../imagens/instagram.png" alt=""></a>
            </div>
            
        </footer>


    </div>


    <script>
        let todosVideos = []
        let categoriasGlobais = []
        let fontSize = parseInt(localStorage.getItem('fontSize'), 10) || 20

        async function mostrarVideo() {
            try {
                let res = await fetch('https://projeto-pi-onrender.onrender.com/videos');
                todosVideos = await res.json()
                exibirVideos(todosVideos)
            } catch (error) {
                console.error(error);
            }
        }

        function exibirVideos(lista) {
            const videosContent = document.getElementById('content-videos');
            videosContent.innerHTML = ''

            lista.forEach((video) => {
                let videoElement = document.createElement('video');
                let videoCard = document.createElement('div');
                let titulo = document.createElement('p');
                let link = document.createElement('a');
                link.href = `video.html?id=${video.id}`
                link.style.textDecoration = 'none';
                link.style.color = 'inherit';



                videoCard.className = "videoCard";
                videoElement.poster = `https://projeto-pi-onrender.onrender.com/uploads/${video.thumbnail}`;
                videoElement.style.borderRadius = '8px'
                videoElement.style.maxWidth = '100%'
                videoElement.style.height = '180px'
                titulo.innerText = video.nome

                link.appendChild(videoElement);
                link.appendChild(titulo);
                videoCard.appendChild(link);
                videosContent.appendChild(videoCard);
            });
        }

        function filtrarVideos() {
            const termo = document.getElementById('pesquisarCurso').value.toLowerCase();

            const filtrados = todosVideos.filter(video =>
                video.nome.toLowerCase().includes(termo)
            );

            exibirVideos(filtrados);
        }

        function clickAcessibilidade() {
            const options = document.getElementById("optionsAcessibilidade");
            const isVisible = options.style.display === "flex";
            options.style.display = isVisible ? "none" : "flex";
        }

        function autoContraste() {
            document.body.classList.toggle('alto-contraste')
            if (document.body.classList.contains('alto-contraste')) {
                localStorage.setItem('modoContraste', 'ativo');
            } else {
                localStorage.removeItem('modoContraste');
            }
        }

        function aplicarTamanhoDaFonte() {
            document.body.style.fontSize = fontSize + 'px'
            localStorage.setItem('fontSize', fontSize)
        }

        function aumentarFonte(e) {
            if (e && e.preventDefault) e.preventDefault()

            if (fontSize < 26) {
                fontSize += 2
                aplicarTamanhoDaFonte()
            }
        }
        function diminuirFonte(e) {

            if (e && e.preventDefault) e.preventDefault()
            if (fontSize > 20) {
                fontSize -= 2
                aplicarTamanhoDaFonte()
            }
        }


        function aplicarDaltonismo(tipo) {
            document.body.classList.remove('protanopia', 'deuteranopia', 'tritanopia')

            if (tipo) {
                document.body.classList.add(tipo)
                localStorage.setItem('modoDaltonismo', tipo)
            } else {
                localStorage.removeItem('modoDaltonismo')
            }
        }

        function ativarDaltonismo() {
            const modoAtual = localStorage.getItem('modoDaltonismo')
            let novoModo;

            if (modoAtual === 'protanopia') {
                novoModo = 'deuteranopia'
                alert('üîµ Modo Daltonismo: Deuteranopia ativado')
            } else if (modoAtual === 'deuteranopia') {
                novoModo = 'tritanopia'
                alert('üü¢ Modo Daltonismo: Tritanopia ativado')
            } else if (modoAtual === 'tritanopia') {
                novoModo = null;
                alert('üîÅ Modo Daltonismo desativado')
            } else {
                novoModo = 'protanopia'
                alert('üî¥ Modo Daltonismo: Protanopia ativado')
            }

            aplicarDaltonismo(novoModo)
        }

        document.getElementById('btnDaltonismo').addEventListener('click', ativarDaltonismo);



        function filtrarPorCategoria(categoriaNome) {
            if (!categoriaNome) {
                exibirVideos(todosVideos);
                return;
            }

            const categoriaSelecionada = categoriasGlobais.find(cat => cat.nome === categoriaNome);
            if (!categoriaSelecionada) {
                exibirVideos([]);
                return;
            }

            const filtrados = todosVideos.filter(video =>
                video.categoria_id === categoriaSelecionada.id
            );

            exibirVideos(filtrados);
        }


        async function carregarCategorias() {
            try {
                const res = await fetch('https://projeto-pi-onrender.onrender.com/categorias');
                const categorias = await res.json();
                categoriasGlobais = categorias;
                const lista = document.getElementById('lista-categorias');
                lista.innerHTML = ''

                const liTodos = document.createElement('li');
                liTodos.innerHTML = `<a href="#" data-categoria="">Todos</a>`;
                lista.appendChild(liTodos);

                categorias.forEach(cat => {
                    const li = document.createElement('li');
                    li.innerHTML = `<a href="#" data-categoria="${cat.nome}">${cat.nome}</a>`;
                    lista.appendChild(li);
                });

                const botoesCategoria = lista.querySelectorAll('a');
                botoesCategoria.forEach(botao => {
                    botao.addEventListener('click', (e) => {
                        e.preventDefault();
                        const categoria = botao.getAttribute('data-categoria');
                        filtrarPorCategoria(categoria);
                        lista.querySelectorAll('li').forEach(li => li.classList.remove('ativo'))
                        botao.parentElement.classList.add('ativo')

                    });
                });

            } catch (error) {
                console.error('Erro ao carregar categorias:', error);
            }
        }




        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('pesquisarCurso').addEventListener('input', filtrarVideos)
            document.getElementById('btnContraste').addEventListener('click', autoContraste)


            const btnMais = document.getElementById('btnMais');
            const btnMenos = document.getElementById('btnMenos');

            if (btnMais) btnMais.addEventListener('click', aumentarFonte);
            if (btnMenos) btnMenos.addEventListener('click', diminuirFonte);
            aplicarTamanhoDaFonte()

            mostrarVideo()
            carregarCategorias()

            if (localStorage.getItem('modoContraste') === 'ativo') {
                document.body.classList.add('alto-contraste');
            }

            const salvo = localStorage.getItem('modoDaltonismo');
            if (salvo) aplicarDaltonismo(salvo)
        })

        window.addEventListener('scroll', () => {
            const footer = document.querySelector('footer')
            const scrollTop = window.scrollY + window.innerHeight
            const docHeight = document.documentElement.scrollHeight

            if (scrollTop >= docHeight - 10) {
                footer.classList.add('show');
            } else {
                footer.classList.remove('show');
            }
        })




    </script>



</body>

</html>